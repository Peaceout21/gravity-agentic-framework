Gravity Agentic Framework - Progress Log
=======================================

Purpose
-------
Chronological context log of experiments, decisions, and outcomes. This is a running history to preserve execution context across sessions.

Format
------
[DATE] AREA
- Context
- What was tried
- Outcome
- Decision / Next

[2026-02-06] Blueprint and architecture alignment
- Context: Started from AGENTIC_ARCHITECTURE_BLUEPRINT.md.
- What was tried: Locked hybrid stack (LangGraph + LangChain + SQLite checkpoints), typed payload contracts, 4-agent flow.
- Outcome: Agreed on graph-node architecture and public interfaces.
- Decision / Next: Implement greenfield runtime and module layout.

[2026-02-07] Core implementation and testing foundation
- Context: Needed production-ready baseline for ingestion -> analysis -> index -> ask.
- What was tried: Implemented graphs, adapters, API/worker, Streamlit app, test scaffolding.
- Outcome: End-to-end local path available; initial tests in place.
- Decision / Next: Add production architecture plan and hardening items.

[2026-02-07] Production architecture planning
- Context: User target raised to 500-1000 users.
- What was tried: Prepared production architecture guidance (API, worker, queue, DB, scaling).
- Outcome: docs/PRODUCTION_ARCHITECTURE_IMPLEMENTATION.md created and iterated.
- Decision / Next: implement backfill contract, auth scoping, deterministic E2E tests.

[2026-02-08] Reliability and release checks
- Context: Live integration sometimes skipped due to API not running.
- What was tried: Added/ran release checks and clarified test expectations for reachable/unreachable env.
- Outcome: Integration test behavior documented; suite can pass with intentional skip semantics.
- Decision / Next: keep release gate requiring green OR explicit skip-by-design evidence.

[2026-02-08] UX and operations expansion
- Context: Need productized experience for analysts and ops users.
- What was tried: Added multi-page Streamlit UX (Dashboard, Notifications, Watchlist, Ask, Ops Dashboard), API endpoints for ops and notification management.
- Outcome: Full user journey became demo-ready in local mode/API mode.
- Decision / Next: improve Ask usefulness and filing coverage clarity.

[2026-02-09] Ask templates and filing-aware guidance
- Context: Analysts needed guided prompts and better context when coverage is missing.
- What was tried: Template runs, period picker, persisted history merge, metadata backfill path, low-relevance coverage brief.
- Outcome: Ask workflow now supports repeatable template analysis and clearer user feedback.
- Decision / Next: validate UI behavior and harden release readiness.

[2026-02-10] Release hardening
- Context: Need deterministic branch state and release confidence.
- What was tried: status checks, staging/commit hygiene, rerun suite in release-like env, tag guidance.
- Outcome: release process clarified with explicit gates.
- Decision / Next: proceed only after deterministic branch and validated suite.

[2026-02-16] India market experiment (separate branch)
- Context: Explore expansion beyond US SEC.
- What was tried:
  - Added market provider abstraction + factory.
  - Implemented IN_NSE and IN_BSE provider adapters.
  - Made API/worker/watchlist/notifications market-aware.
  - Added tests for provider logic and multi-market behavior.
- Outcome:
  - Local tests passed.
  - Live runs for BHEL/NALCO/Bharat Coking Coal returned 0 records; observed NSE timeouts and source variability.
- Decision / Next:
  - Keep this track experimental on separate branch.
  - Do not block US SEC release path.

[2026-02-16] SEA market research
- Context: Evaluate additional growth markets at practical cost.
- What was tried: Assessed exchange/operator data options and implementation implications for SEA markets.
- Outcome: Confirmed feeds exist but access/cost/reliability vary; integration is feasible but requires source-level contracts.
- Decision / Next: prioritize shippable core (US SEC) first; treat new markets as staged experiments.

[2026-02-17] Rollout and documentation consolidation
- Context: Need investor/ops-friendly execution clarity and preserved context.
- What was tried: Added rollout matrix and maintained this progress log.
- Outcome: Shared artifact set now includes journey, production architecture, rollout matrix, and progress history.
- Decision / Next:
  - Continue appending entries for every major experiment/release decision.
  - Use rollout gates as go/no-go checklist for launch.

[2026-02-17] SOTA implementation planning kickoff
- Context: Need a concrete implementation path using latest practical agentic patterns without coupling to India experiment branch.
- What was tried: Added a dedicated SOTA plan covering reliability core, metric-derivation agent, coverage assessor, observability, and scale gates.
- Outcome: Clear phased execution plan with release-critical tests and API contract additions.
- Decision / Next:
  - Execute P0 workstreams first (reliability, ask quality, tenant safety).
  - Track each implementation milestone in this log and validate against rollout matrix gates.

[2026-02-17] P0 reliability sprint - replay + dead-letter diagnostics
- Context: Needed concrete P0 execution (not only planning) for production hardening.
- What was tried:
  - Added filing replay API contract (`POST /filings/replay`) and runtime replay execution path.
  - Added dead-letter persistence fields on filings (`dead_letter_reason`, `last_error`) plus replay tracking (`replay_count`, `last_replay_at`).
  - Added strict runtime payload coercion/validation in graph runtime for filing/analysis/receipt contracts.
- Outcome:
  - Replay is now callable via API and client wrapper.
  - Failure triage has direct root-cause fields in filings/recent failures.
  - Contract mismatches are surfaced early and recorded in errors/dead-letter metadata.
- Decision / Next:
  - Start next P0 item: Ask quality uplift via metric-derivation node + coverage scoring wiring.
  - Add replay button/action in Ops UI after API contract stabilization.

[2026-02-17] P0 tenant-safety hardening - watchlist scope enforcement
- Context: Remaining filing endpoints exposed broader dataset than user watchlist scope.
- What was tried:
  - Scoped `/filings` results to authenticated user watchlist tickers.
  - Scoped `/filings/ticker-count` to watchlist; non-watched tickers return zero.
  - Scoped `/filings/replay` to watched tickers; out-of-scope replay returns 403.
  - Added endpoint tests for scoped/forbidden behaviors.
- Outcome:
  - Tenant-facing filing actions now align with watchlist-based row-level access policy.
  - Full test suite stayed green after scoping changes.
- Decision / Next:
  - Continue with remaining P0: Ask quality uplift (metric derivation + provenance fields).

[2026-02-17] P0 ask quality uplift - metric derivation and provenance
- Context: Ask responses needed explicit inference confidence and traceability for derived metrics.
- What was tried:
  - Added a bounded `derive_metric` node to the query graph between retrieval fusion and synthesis.
  - Propagated `confidence` and `derivation_trace` through `MarkdownAnswer`, API query responses, and template run responses/history.
  - Extended SQLite/Postgres `ask_template_runs` schema and state manager methods to persist confidence + derivation trace.
  - Added unit test coverage for derivation behavior and persistence contract.
- Outcome:
  - Derived metric outputs now include auditable reasoning metadata.
  - Analyst-facing template history can show confidence/trace consistently across sessions.
  - Full test suite remains green.
- Decision / Next:
  - Wire these fields into Ask/Dashboard UI rendering.
  - Add policy thresholds (e.g., low-confidence labeling) for analyst trust cues.

[2026-02-20] P0 UI trust cues - confidence and derivation surfaced
- Context: Derivation/confidence existed in backend contracts but was not visible to end-users in primary UI paths.
- What was tried:
  - Added shared confidence policy helper with deterministic thresholds (high/medium/low).
  - Rendered confidence labels, low-confidence warning text, and derivation trace expanders in Ask and Dashboard quick ask/template flows.
  - Added UI helper unit tests and re-ran full suite.
- Outcome:
  - Analysts now see confidence + reasoning breadcrumbs directly where answers are consumed.
  - Full suite remained green after UI wiring.
- Decision / Next:
  - Add optional Ops visibility for low-confidence answer rates and template-level quality trends.

Open Threads
------------
1. Finalize US SEC go-live checklist run and tag.
2. Validate notification UX and Ask template metrics under real analyst usage.
3. Decide if/when to revive India/SEA experimental branch based on data source economics.
4. Add periodic summary script to auto-append run outcomes to this log (optional).

How to maintain this file
-------------------------
- Append new entries only; do not rewrite prior outcomes unless correcting facts.
- Keep each entry short and decision-focused.
- For each release candidate, include: test status, incident summary, and explicit go/no-go decision.
